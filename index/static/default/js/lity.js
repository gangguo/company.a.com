/* Lity - v2.2.2 - 2016-12-14
* http://sorgalla.com/lity/
* Copyright (c) 2015-2016 Jan Sorgalla; Licensed MIT */
(function(b,a){if(typeof define==="function"&&define.amd){define(["jquery"],function(c){return a(b,c)})}else{if(typeof module==="object"&&typeof module.exports==="object"){module.exports=a(b,require("jquery"))}else{b.lity=a(b,b.jQuery||b.Zepto)}}}(typeof window!=="undefined"?window:this,function(L,a){var r=L.document;var n=a(L);var e=a.Deferred;var i=a("html");var k=[];var b="aria-hidden";var c="lity-"+b;var g='a[href],area[href],input:not([disabled]),select:not([disabled]),textarea:not([disabled]),button:not([disabled]),iframe,object,embed,[contenteditable],[tabindex]:not([tabindex^="-"])';var d={handler:null,handlers:{image:y,inline:z,youtube:N,vimeo:K,googlemaps:v,facebookvideo:t,iframe:x},template:'<div class="lity" role="dialog" aria-label="Dialog Window (Press escape to close)" tabindex="-1"><div class="lity-wrap" data-lity-close role="document"><div class="lity-loader" aria-hidden="true">Loading...</div><div class="lity-container"><div class="lity-content"></div><button class="lity-close" type="button" aria-label="Close (Press escape to close)" data-lity-close>&times;</button></div></div></div>'};var j=/(^data:image\/)|(\.(png|jpe?g|gif|svg|webp|bmp|ico|tiff?)(\?\S*)?$)/i;var o=/(youtube(-nocookie)?\.com|youtu\.be)\/(watch\?v=|v\/|u\/|embed\/?)?([\w-]{11})(.*)?/i;var m=/(vimeo(pro)?.com)\/(?:[^\d]+)?(\d+)\??(.*)?$/;var h=/((maps|www)\.)?google\.([^\/\?]+)\/?((maps\/?)?\?)(.*)/i;var f=/(facebook\.com)\/([a-z0-9_-]*)\/videos\/([0-9]*)(.*)?$/i;var l=(function(){var O=r.createElement("div");var Q={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var P in Q){if(O.style[P]!==undefined){return Q[P]}}return false})();function J(P){var O=e();if(!l||!P.length){O.resolve()}else{P.one(l,O.resolve);setTimeout(O.resolve,500)}return O.promise()}function H(O,P,Q){if(arguments.length===1){return a.extend({},O)}if(typeof P==="string"){if(typeof Q==="undefined"){return typeof O[P]==="undefined"?null:O[P]}O[P]=Q}else{a.extend(O,P)}return this}function D(T){var S=decodeURI(T.split("#")[0]).split("&");var Q={},R;for(var O=0,P=S.length;O<P;O++){if(!S[O]){continue}R=S[O].split("=");Q[R[0]]=R[1]}return Q}function p(P,O){return P+(P.indexOf("?")>-1?"&":"?")+a.param(O)}function I(P,O){var Q=P.indexOf("#");if(-1===Q){return O}if(Q>0){P=P.substr(Q)}return O+P}function s(O){return a('<span class="lity-error"/>').append(O)}function y(T,S){var P=(S.opener()&&S.opener().data("lity-desc"))||"Image with no description";var R=a('<img src="'+T+'" alt="'+P+'"/>');var O=e();var Q=function(){O.reject(s("Failed loading image"))};R.on("load",function(){if(this.naturalWidth===0){return Q()}O.resolve(R)}).on("error",Q);return O.promise()}y.test=function(O){return j.test(O)};function z(T,R){var P,S,Q;try{P=a(T)}catch(O){return false}if(!P.length){return false}S=a('<i style="display:none !important"/>');Q=P.hasClass("lity-hide");R.element().one("lity:remove",function(){S.before(P).remove();if(Q&&!P.closest(".lity-content").length){P.addClass("lity-hide")}});return P.removeClass("lity-hide").after(S)}function N(P){var O=o.exec(P);if(!O){return false}return x(I(P,p("https://www.youtube"+(O[2]||"")+".com/embed/"+O[4],a.extend({autoplay:1},D(O[5]||"")))))}function K(P){var O=m.exec(P);if(!O){return false}return x(I(P,p("https://player.vimeo.com/video/"+O[3],a.extend({autoplay:1},D(O[4]||"")))))}function t(P){var O=f.exec(P);if(!O){return false}if(0!==P.indexOf("http")){P="https:"+P}return x(I(P,p("https://www.facebook.com/plugins/video.php?href="+P,a.extend({autoplay:1},D(O[4]||"")))))}function v(P){var O=h.exec(P);if(!O){return false}return x(I(P,p("https://www.google."+O[3]+"/maps?"+O[6],{output:O[6].indexOf("layer=c")>0?"svembed":"embed"})))}function x(O){return'<div class="lity-iframe-container"><iframe frameborder="0" allowfullscreen src="'+O+'"/></div>'}function M(){return r.documentElement.clientHeight?r.documentElement.clientHeight:Math.round(n.height())}function A(P){var O=q();if(!O){return}if(P.keyCode===27){O.close()}if(P.keyCode===9){w(P,O)}}function w(O,R){var P=R.element().find(g);var Q=P.index(r.activeElement);if(O.shiftKey&&Q<=0){P.get(P.length-1).focus();O.preventDefault()}else{if(!O.shiftKey&&Q===P.length-1){P.get(0).focus();O.preventDefault()}}}function G(){a.each(k,function(O,P){P.resize()})}function E(O){if(1===k.unshift(O)){i.addClass("lity-active");n.on({resize:G,keydown:A})}a("body > *").not(O.element()).addClass("lity-hidden").each(function(){var P=a(this);if(undefined!==P.data(c)){return}P.data(c,P.attr(b)||null)}).attr(b,"true")}function F(O){var P;O.element().attr(b,"true");if(1===k.length){i.removeClass("lity-active");n.off({resize:G,keydown:A})}k=a.grep(k,function(Q){return O!==Q});if(!!k.length){P=k[0].element()}else{P=a(".lity-hidden")}P.removeClass("lity-hidden").each(function(){var Q=a(this),R=Q.data(c);if(!R){Q.removeAttr(b)}else{Q.attr(b,R)}Q.removeData(c)})}function q(){if(0===k.length){return null}return k[0]}function u(U,S,R,T){var Q="inline",O;var P=a.extend({},R);if(T&&P[T]){O=P[T](U,S);Q=T}else{a.each(["inline","iframe"],function(V,W){delete P[W];P[W]=R[W]});a.each(P,function(W,V){if(!V){return true}if(V.test&&!V.test(U,S)){return true}O=V(U,S);if(false!==O){Q=W;return false}})}return{handler:Q,content:O||""}}function C(Y,U,T,O){var X=this;var W;var S=false;var R=false;var Q;var P;U=a.extend({},d,U);Q=a(U.template);X.element=function(){return Q};X.opener=function(){return T};X.options=a.proxy(H,X,U);X.handlers=a.proxy(H,X,U.handlers);X.resize=function(){if(!S||R){return}P.css("max-height",M()+"px").trigger("lity:resize",[X])};X.close=function(){if(!S||R){return}R=true;F(X);var Z=e();if(O&&(r.activeElement===Q[0]||a.contains(Q[0],r.activeElement))){try{O.focus()}catch(aa){}}P.trigger("lity:close",[X]);Q.removeClass("lity-opened").addClass("lity-closed");J(P.add(Q)).always(function(){P.trigger("lity:remove",[X]);Q.remove();Q=undefined;Z.resolve()});return Z.promise()};W=u(Y,X,U.handlers,U.handler);Q.attr(b,"false").addClass("lity-loading lity-opened lity-"+W.handler).appendTo("body").focus().on("click","[data-lity-close]",function(Z){if(a(Z.target).is("[data-lity-close]")){X.close()}}).trigger("lity:open",[X]);E(X);a.when(W.content).always(V);function V(Z){P=a(Z).css("max-height",M()+"px");Q.find(".lity-loader").each(function(){var aa=a(this);J(aa).always(function(){aa.remove()})});Q.removeClass("lity-loading").find(".lity-content").empty().append(P);S=true;P.trigger("lity:ready",[X])}}function B(R,Q,P){if(!R.preventDefault){P=a(P)}else{R.preventDefault();P=a(this);R=P.data("lity-target")||P.attr("href")||P.attr("src")}var O=new C(R,a.extend({},P.data("lity-options")||P.data("lity"),Q),P,r.activeElement);if(!R.preventDefault){return O}}B.version="2.2.2";B.options=a.proxy(H,B,d);B.handlers=a.proxy(H,B,d.handlers);B.current=q;a(r).on("click.lity","[data-lity]",B);return B}));